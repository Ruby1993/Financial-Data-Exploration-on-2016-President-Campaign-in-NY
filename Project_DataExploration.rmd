
---
title: "2016 Presidential Campaign Finance Contribution Analysis at New York"
output: html_document
---

======================================================================

by RUI ZHANG
December 05,2017

## Introduction

This is the data exploration on 2016 US presidential campaign 
finance contribution in New York state. The dataset is available at 
http://classic.fec.gov/disclosurep/pnational.do, which includes the 
financial information disclosed by each presidential candidates for 
their campaign and all the individual donations that were over $100,000.

In 2016 presidential campaign, the result unexpectedly brings Trump 
into White House, and Hilary missed the chance to be the first female
president in the US. When people naturally assumed they would see a 
female president next morning, this reversal astonished Americans without 
clues. So, what if we have the financial campaign data? What can we get 
from the dataset? I will explore the nature of campaign contributions and 
see if there are any interesting relationships in the data, such as:
- Which party and candidates got the most support? 
- What's the difference between different parties' supporters? 
- How are the donations distributed spatially? 
- Is there any model that we could build and bring some predictions?

```{r message=FALSE, warning=FALSE, packages}
# Load all of the packages that you end up using in your analysis in this code
# chunk.

# Notice that the parameter "echo" was set to FALSE for this code chunk. This
# prevents the code from displaying in the knitted HTML output. You should set
# echo=FALSE for all code chunks in your file, unless it makes sense for your
# report to show the code that generated a particular plot.

# The other parameters for "message" and "warning" should also be set to FALSE
# for other code chunks once you have verified that each plot comes out as you
# want it to. This will clean up the flow of your report.

library(ggplot2)
library(dplyr)
library(psych)
library("gridExtra")
library(zipcode)
library(choroplethrZip)
library(choroplethr)
library(devtools)
library(choroplethrMaps)
library(gender)
library(lubridate)# for the year() function
library(cowplot)# Could define the size of the plot
library(polycor) # hector

getwd()

```



```{r results="hide", Load_the_Data,warning=FALSE, message=FALSE}
# Load the Data
#wine<-read.csv("data/wineQualityReds.csv")
#summary(wine)
#loan<-read.csv("data/prosperLoanData.csv")
#head(loan)
campaign<-read.csv("P00000001-NY.csv",row.names = NULL)
names(campaign)
# subeset the dataset - CLEARLY STATE THE VARIABLES I used
#tmpdata <- subset(campaign, select = -c(varname1, varname2))
#tmpdata <- campaign[ , !names(campaign) %in% c("varname1", "varname2")]
dim(campaign)
str(campaign)
head(campaign)
#View(campaign)
```


> **Description of Data Set**: In this dataset, there are 649460 records with 18 
variables. 
Most varaibles are catergorical.The dataset include the info about the candidate
they support, the contributor name, location, career and the money they 
contributed in New York.

## Univariate Plots Section

> **Hint**: preliminary exploration of the dataset. summaries/univariate plots to
understand the structure of the individual variables in your dataset.

### Summary
```{r Data_Exploration_1}
str(campaign)
```

```{r Data_Exploration_2}
summary(campaign)
```

In order to fully understand the data of presidential campaign, I would love to 
add two more datasets - zipcode and demographic into our dataset.

```{r warning=FALSE, message=FALSE, Data_Exploration_3}
# geographic data
#data(zip.map)
#str(zip.map)
data(zipcode)
str(zipcode)
# demographic data
data(df_zip_demographics)
str(df_zip_demographics)
```
## Data Manipulation

Before doing anything related to preprocessing, I would love to first select the 
features that we are interested in or might be helpful for the processing or analysis.

feature selection
```{r results="hide", warning=FALSE, message=FALSE, Data_Manipulation_1}

# Clearly state the names of column
#names(campaign)
campaign <- campaign[ , !names(campaign) %in% c("cmte_id", "vcand_id","receipt_desc", "memo_cd", "memo_text", "form_tp", "file_num", "tran_id", "election_tp")]
#campaign<-campaign[,1:11]
```

```{r warning=FALSE, message=FALSE, Data_Manipulation_2}
hist(log(campaign$contb_receipt_amt),main="Histgram of the 2017 Presidential Contribution")
```

> **Dataset Issue**: This dataset includes 649460 obs. of 18 variables, and 
there are 15 categorical variables. Some missing values are in the contbr_zip, 
contbr_employer, contbr_occupation, and election_tp. Also, There are some 
inconsistency in the contbr_employer and contributor street name that we need 
to preprocessed. By the way, as there is no parties info for each candidate, I 
will add a new variable for that.In addition, contb_receipt_amt has some 
negative value which we could notify in the above plot, and I will remove those 
values.

So, in general, we will do 

- Remove negative values and Nan in contribution amount fields.

- Change the type of certain field, especially the date.

- Clean up the zipcode field to 5 digits.

- Add party info for each contribution.

- Split the first name and last name in the dataset, in order to get the gender 
info based on the first name.



```{r, echo=FALSE, results="hide", warning=FALSE, message=FALSE, Data_Manipulation_3}

#Remove the negative value in contb_receipt_amt
campaign<-filter(campaign,contb_receipt_amt>0,contb_receipt_amt!='N/A')

#change the data type
campaign$date<-as.Date(campaign$contb_receipt_dt, format='%d-%b-%y')

# add a new variable about the time difference before the election date
elec.date<-as.Date("19-Dec-16",format='%d-%b-%y')
campaign$date_upto_elec<-as.integer(elec.date-campaign$date)

# Add the parties info for the candidate

campaign$party<-ifelse(campaign$cand_nm %in% c("Clinton, Hillary Rodham","Lessig, Lawrence","O'Malley, Martin Josep","Sanders, Bernard"," Webb, James Henry Jr"),c("democrat"),c("republican"))

# Johnson, Gary - Libertarian Party
# McMullin, Evan - Independents
# Stein, Jill - Green Party

campaign$party[campaign$cand_nm %in% c("Johnson, Gary","McMullin, Evan","Stein, Jill")]="Libtertarian/other"

#Split the first name and last name
out<-strsplit(as.character(campaign$cand_nm),', ')
out1<-do.call(rbind,out)
#out1[,1]
campaign$cand_LastName<-out1[,1]
campaign$cand_FirstName<-out1[,2]

out.contbr<-strsplit(as.character(campaign$contbr_nm),', ')
out.contbr1<-do.call(rbind,out.contbr)

campaign$contbr_LastName<-out.contbr1[,1]
campaign$contbr_FirstName<-out.contbr1[,2]

```

Now, I want to clean the zipcodes to 5 digits, and then we can relate them to 
zipcode and demographic datasets.

```{r,echo=FALSE, results="hide", warning=FALSE, message=FALSE, Data_Manipulation_4}

#As there are a lot discrepency in this dataset, it need time to clean it up. From the perspective of preprocessing difficulties, I will choose zip code and keep 5 digits to represent the location info.

#campaign$contbr_zip
#library(zipcode)
campaign$zipcode<-clean.zipcodes(campaign$contbr_zip)
campaign$zipcode<-substr(campaign$zipcode,1,5)
#length(table(campaign$zipcode))

#remove all the records that are not in New York
campaign<-subset(campaign,(campaign$zipcode>10001 & campaign$zipcode<14905)|campaign$zipcode==00501|campaign$zipcode==00544|campaign$zipcode==06390)
#table(campaign$zipcode)

#Merge the dataset with the zipcode dataset
campaign<-merge(campaign, zipcode, by.x="zipcode",by.y="zip", all.x=TRUE)
#str(campaign)

# filter the data that only for New York State
campaign<-filter(campaign,campaign$state=='NY')
#str(campaign)
#length(table(campaign_ny$zipcode))
subset(campaign,is.na(city))

# Merge the dataset with the demographics dataset
campaign<-merge(campaign, df_zip_demographics, by.x="zipcode",by.y="region", all.x=TRUE)
str(campaign)

```

Finally, I will add gender info into the dataset based on the candidate first 
name. Not all the people could get their gender prediction as their first name 
might be abbreviated or non-traditional.

```{r, echo=FALSE, results="hide", warning=FALSE, message=FALSE, Data_Manipulation_5}
# Here I set the year of the name is 2012
campaign$contbr_year<-2012
#library(gender)
result<-gender_df(campaign,name_col = "contbr_FirstName",year_col = 'contbr_year', method = "ssa" )
result<-result[,c("name","gender")]

campaign<-campaign%>%
  left_join(result,by=c("contbr_FirstName"="name"))

str(campaign)
```


> **Summary**:After processing the data and adding additional variables, the 
dataset has some addtional variables, and the detialed explaination is below:

1. date_upto_elec: Num of dates before the presidential final campaign result.

2. party: candidateâ€™s political party affiliation.

3. contbr_FirstName: Split the contributor name and get the first name  info.

4. contbr_LastName: Split the contributor name and get the last name  info.

5. cand_FirstName: Split the candidate name and get the first name info.

6. cand_LastName:split the candidate name and get the last name info.

7. longitude: The contributor's geolocation longitude.

8. latitude: The contributor's geolocation latitude.

9. total_population: the correspondent zipcode region population.

10. percent_white: the correspondent zipcode region white people percentage.

11. percent_black: the correspondent zipcode region black people percentage.

12. percent_asian: the correspondent zipcode region asian people percentage.

13. percent_hispanic: the correspondent zipcode region hispanic people percentage.

14. per_capita_income: the correspondent zipcode region income per capita.

15. median_rent:  the correspondent zipcode region median rent price.

16. median_age:  the correspondent zipcode region median age.

17. gender: the gender of contributor.

## Univariate Plot Analysis

As we preprocess the dataset, now we could start the univariate plot analysis. 
From the general perspective, Hillary was the candidate that receive most 
contributions,and democrat got more contributions in New York. The city with 
more donations is New York, and retired people is the important donation group 
that had a big proportion in 2017. The median of contribution in 2017 
presidential campaign is 274.

```{r echo=FALSE, Univariate_Plots_1}
#summary(campaign)
```

For the most important field contribution amount, we could see that most of 
contributions are below 1000 dollars and the distribution is right-screwed distribution.

```{r echo=FALSE, message=FALSE, warning=FALSE,Univariate_Plots_2}
# #a1<-ggplot(data = campaign, aes(x = contb_receipt_amt)) +
#   geom_density(fill = "mediumpurple4", color = "black")+
#   scale_x_log10(breaks = c(10, 150,1000,4000))+
#   ggtitle("Distribution of donations in 2017 Presidential Campaign")+
#   xlab("Contribution Recevied")
# 
# #a2<-ggplot(data = campaign, aes(x = contb_receipt_amt)) +
#    geom_histogram(binwidth = 50, fill = "mediumpurple4", color = "black") +
#   scale_x_continuous(breaks = c(250, 500, 1000, 1500, 2000, 2500)) +
#   coord_cartesian(xlim = c(0, 3000))
# 
# #a3<-ggplot(data = campaign, aes(x = contb_receipt_amt)) +
#   geom_histogram(binwidth = 25, fill = "mediumpurple4", color = "black") +
#   scale_x_continuous(breaks = seq(0, 250, 50)) +
#   coord_cartesian(xlim = c(0, 300))
# 
# #a4<-ggplot(data = campaign, aes(x = contb_receipt_amt)) +
#  geom_histogram(binwidth = 5, fill = "mediumpurple4", color = "black") +
#   scale_x_continuous(breaks = seq(0, 60, 5)) +
#   coord_cartesian(xlim = c(0, 60))

#grid.arrange(a1, a2, a3,a4, ncol = 1)
```

Now, let's check the date of those contribution.

For the date info related to those donations, we could notice that there were 
more donations in 2016, and seems there are more people to donate except the 
holiday season.

```{r echo=FALSE, message=FALSE, warning=FALSE,Univariate_Plots_3}
b1 <- ggplot(aes(x=date),data=filter(campaign,date_upto_elec>0))+
  geom_histogram(binwidth = 7)+
  ggtitle("Count of Donations with Date")+
  theme(plot.title = element_text(hjust = 0.5),axis.text.x = element_text(size=7, angle=45),axis.title=element_text(size=9))+
  ylab("Count of Contribution received ")+
  xlab("Date")+
  scale_x_date(limits=c(as.Date("2015-01-01"),as.Date("2017-02-01")), date_breaks = '3 month',date_labels = "%m-%Y")
  
b2 <- ggplot(data = campaign, aes(x = as.factor(year(date)))) +
    geom_bar(fill = "navyblue", color = "black")+
   xlab("Year")+
  theme(axis.title=element_text(size=9))

b3 <- ggplot(data = campaign, aes(x = as.factor(month(date)))) +
    geom_bar(fill = "navyblue", color = "black")+
   xlab("Month")+
  theme(axis.title=element_text(size=9))

b4 <- ggplot(data = campaign, aes(x = as.factor(day(date)))) +
    geom_bar(fill = "navyblue", color = "black")+
   xlab("Day")+
  theme(axis.title=element_text(size=9), axis.text.x =element_text(angle = 45) )


grid.arrange(b1, b2, b3,b4, ncol = 2) 

```

In 2017 presidential campaign, there are 5 candidates are democrats, 
3 are third party and all the others are republican.

As we could see, most contributions are gotten by democrats as new york is huge 
state for democrat supporter.

```{r echo=FALSE,message=FALSE, warning=FALSE, Univariate_Plots_5}
#party
ggplot(aes(x=party),data=campaign)+
   ggtitle("Count of Contribution by Party")+
  geom_bar()+
   theme(axis.text= element_text(size=8),plot.title = element_text(hjust = 0.5),axis.title =element_text(size=12) )+
  ylab("Number of Contribution received")
```

Then, for the huge part in the dataset related to contributor info, 
I will go through the name, location info, gender info and occupation info to 
find out what's characteristic behind each party's supporters.

First, Name info. As the length is 119407 and the total is 649460, which means most of contributors only 1-6 several contributions. So it won't be our interest in our analysis.

```{r message=FALSE,results="hide", warning=FALSE, Univariate_Plots_6}

# First, Name info
length(table(campaign$contbr_nm))
mean(table(campaign$contbr_nm))
```

Then, location info. As there are a lot discrepency in this dataset, it need time to clean it up. From the perspective of preprocessing difficulties, I will choose zip code and keep 5 digits to represent the location info.

```{r message=FALSE,results="hide", warning=FALSE, Univariate_Plots_6_2}
length(table(campaign$contbr_city))#2327
table(campaign$contbr_city)
length(table(campaign$contbr_st)) #1
length(table(campaign$contbr_zip))#69031
#library(ggthemes)
#scale_colour_tableau()
```

As we could see,most of donators were from the New York City. 

```{r echo=FALSE, message=FALSE, warning=FALSE,Univariate_Plots_7}
#zip code mapping
#update.packages('rlang')
#update.packages('glue')
#library(glue)
#packageDescription(glue)
#library(choroplethrZip)
#library(choroplethr)
#library(devtools)
#library(choroplethrMaps)
#install_github('arilamstein/choroplethrZip@v1.3.0')

campagin_ny.fm<-campaign%>%
  filter(zipcode!='NA')%>%
   group_by(zipcode)%>%
  summarise(Finance_Ave=mean(contb_receipt_amt),
            Count=n())

campagin_ny.fm$value=campagin_ny.fm$Count
campagin_ny.fm$region=campagin_ny.fm$zipcode
campagin_ny.fm<-na.omit(campagin_ny.fm)
#str(campagin_ny.fm)

# create the map
#str(campagin_ny.fm)
#summary(campagin_ny.fm)
zip_map = ZipChoropleth$new(campagin_ny.fm)
zip_map$ggplot_polygon = geom_polygon(aes(fill = value), 
                                      color = NA)
zip_map$set_zoom_zip(state_zoom  = c("new york"), 
                     county_zoom = NULL, 
                     msa_zoom    = NULL, 
                     zip_zoom    = NULL) 

zip_map$title = "Count of Contribution in New York State "
zip_map$legend = "Count"
zip_map$set_num_colors(5)
choro = zip_map$render()

#create the state outlines
data(df_pop_state)
outline = StateChoropleth$new(df_pop_state)
outline = outline$render_state_outline(c("new york")) 

#render the combined maps
choro_with_outline = choro + outline
choro_with_outline

```

For the demographics features behind the zipcode, they might closely related to 
the contributors in its region. We could see most donators are from regions with 
more white people, more aged from 25 to 50, and income per capita from 20000 to 40000.

```{r echo=FALSE, message=FALSE, warning=FALSE,Univariate_Plots_8}

c1<-ggplot(data = campaign, aes(x = total_population)) +
    geom_histogram(fill = "navyblue", color = "black")

c2<-ggplot(data = campaign, aes(x = percent_white)) +
    geom_histogram(fill = "navyblue", color = "black")

c3<-ggplot(data = campaign, aes(x = percent_black)) +
    geom_histogram(fill = "navyblue", color = "black")

c4<-ggplot(data = campaign, aes(x = percent_asian)) +
    geom_histogram(fill = "navyblue", color = "black")

c5<-ggplot(data = campaign, aes(x = percent_hispanic)) +
    geom_histogram(fill = "navyblue", color = "black")

c6<-ggplot(data = campaign, aes(x = per_capita_income)) +
    geom_histogram(fill = "navyblue", color = "black")

c7<-ggplot(data = campaign, aes(x = median_rent)) +
    geom_histogram(fill = "navyblue", color = "black")

c8<-ggplot(data = campaign, aes(x = median_age)) +
    geom_histogram(fill = "navyblue", color = "black")

 grid.arrange(c1, c2, c3, c4, c5, c6, c7, c8,ncol = 2)


```


For the Gender Info, we could see there are more females contributors than males 
in new york state, but the difference is not that large. What's the reason 
behind that? Is that significant different?

```{r echo=FALSE, message=FALSE, warning=FALSE,Univariate_Plots_9}
# As the company and occupation data are really messy, I will bring a new variable about the gender of the contributor into our dataset and use the gender library to predict their gender based on the name.
library(data.table)
counts<-data.table(with(campaign,ftable(gender)))
ggplot(aes(x=gender,y=Freq),data=counts)+
  geom_bar(stat='identity')+
  geom_text(aes(label=Freq), color='white', vjust=1.6)+
  ggtitle('Number of Contributions by Gender')+
  theme(axis.text= element_text(size=8),plot.title = element_text(hjust = 0.5),axis.title =element_text(size=10))+
  ylab('Count of Contributions ')+
  xlab("Gender")

```

For the occupation info, I will show the top 25 occupations with more 
contributions in the 2017 political campaign.From the plot, we could observe 
that here are several big categories are retired, not employed,self-employed, 
and employed. In the employed group, lawyer, professor, CEO, and docors were 
more actively involoved.

```{r echo=FALSE,message=FALSE, warning=FALSE, Univariate_Plots_10}
# For the occupation info, we could see that there are various occupations in the dataset. I will clean it a little bit.
nurses <- c("RN", "NURSE", "REGISTERED NURSE", "R.N.")
doctors <- c("PHYSICIAN", "DOCTOR")
lawyers <- c("ATTORNEY", "LAWYER")
bosses <- c("CEO", "PRESIDENT", "OWNER", "BUSINESS OWNER", "EXECUTIVE",
            "SMALL BUSINESS OWNER")
managers <- c("MANAGEMENT", "MANAGER", "PROJECT MANAGER")
sales <- c("SALES", "SALES COORDINATOR")
unemployed <- c("NOT EMPLOYED", "NONE", "UNEMPLOYED")
selfs <- c("SELF EMPLOYED", "SELF-EMPLOYED", "REAL ESTATE BROKER",
           "REAL ESTATE AGENT")
real_estates <- c("REAL ESTATE", "REALTOR")
remove <- c("INFORMATION REQUESTED PER BEST EFFORTS",
                  "INFORMATION REQUESTED",
                  "")

campaign$contbr_occupation[
  campaign$contbr_occupation %in% nurses] <- "NURSE"
campaign$contbr_occupation[
  campaign$contbr_occupation %in% doctors] <- "DOCTOR"
campaign$contbr_occupation[
  campaign$contbr_occupation %in% lawyers] <- "LAWYER"
campaign$contbr_occupation[
  campaign$contbr_occupation %in% bosses] <- "CEO"
campaign$contbr_occupation[
  campaign$contbr_occupation %in% managers] <- "MANAGER"
campaign$contbr_occupation[
  campaign$contbr_occupation %in% sales] <- "SALES"
campaign$contbr_occupation[
  campaign$contbr_occupation %in% unemployed] <- "UNEMPLOYED"
campaign$contbr_occupation[
  campaign$contbr_occupation %in% selfs] <- "SELF EMPLOYED"
campaign$contbr_occupation[
  campaign$contbr_occupation %in% real_estates] <- "REAL ESTATE"

#length(table(campaign$contbr_occupation))

campaign_occupation_active<-campaign%>% 
  group_by(contbr_occupation)%>%
  filter(contbr_occupation!="INFORMATION REQUESTED")%>%
   summarise(Amount_Ave=mean(contb_receipt_amt),
             Amount_Sum=sum(contb_receipt_amt),
            Count=n())%>%
            arrange(desc(Count))%>%
            top_n(25)

           

ggplot(aes(x=reorder(contbr_occupation,Count),y=Count),data=filter(campaign_occupation_active,contbr_occupation!="INFORMATION REQUESTED PER BEST EFFORTS",contbr_occupation!="INFORMATION REQUESTED",contbr_occupation!='N/A'))+
  geom_bar(stat="identity")+
  coord_flip()+
  ggtitle("Count of Contributions in Different Occupations")+
   theme(plot.title = element_text(hjust = 0.5))+
  ylab('Occupation')+
  xlab("Count of Contributions Received")


ggplot(aes(x=reorder(contbr_occupation,Amount_Sum),y=Amount_Sum),data=filter(campaign_occupation_active,campaign_occupation_active$contbr_occupation!='',campaign_occupation_active$contbr_occupation!="INFORMATION REQUESTED PER BEST EFFORTS",contbr_occupation!="INFORMATION REQUESTED",contbr_occupation!='N/A'))+
  geom_bar(stat="identity")+
  coord_flip()+
  ggtitle("Total Financial Donations in Different Occupations")+
   theme(plot.title = element_text(hjust = 0.5))+
   ylab('Sum of Contributions Received')+
  xlab("Occupation")
  

```

In general, we could see employed, retired, unemployed actively support the 
presidential campaign in sequence. And for the employed people, laywer, professor, 
CEO are more active, of which laywer and CEO donate the most.

For the employer info, we know the info doesn't clean up and there are several 
names for only one employer. It will take some work if I go thorugh to get all 
that clean up, and i will only focus on the top 25 employer and reduce the duplicates.

```{r echo=FALSE,results="hide", Univariate_Plots_11}
# for the employer info, there are multiple format for one employer such NYU, New York University
length(table(campaign$contbr_employer))

campaign$contbr_employer[campaign$contbr_employer =="SELF-EMPLOYED"|campaign$contbr_employer =="SELF EMPLOYED"|campaign$contbr_employer =="SELF"|campaign$contbr_employer =="SELF EMPLOYED-EMPLOYED"]="SELF-EMPLOYED"

campaign$contbr_employer[campaign$contbr_employer =="N/A"|campaign$contbr_employer =="NONE"|campaign$contbr_employer ==""|campaign$contbr_employer =="NA"]="N/A"

campaign$contbr_employer[campaign$contbr_employer =="NEW YORK UNIVERSITY"|campaign$contbr_employer =="NYU"]="NEW YORK UNIVERSITY"

campaign$contbr_employer[campaign$contbr_employer =="CITY UNIVERSITY OF NEW YORK"|campaign$contbr_employer =="CUNY"]="CITY UNIVERSITY OF NEW YORK"

campaign$contbr_employer[campaign$contbr_employer =="NEW YORK CITY DEPARTMENT OF EDUCATION"|campaign$contbr_employer =="NYC DOE"]="NYC DOE"

campaign$contbr_employer[campaign$contbr_employer =="NOT EMPLOYED"|campaign$contbr_employer =="UNEMPLOYED"]="UNEMPLOYED"

campaign$contbr_employer[campaign$contbr_employer =="INFORMATION REQUESTED"|campaign$contbr_employer =="INFORMATION REQUESTED PER BEST EFFORTS"]="INFORMATION REQUESTED"

campaign%>% group_by(contbr_employer)%>%
   summarise(Amount_Ave=mean(contb_receipt_amt),
             Amount_Sum=sum(contb_receipt_amt),
            Count=n())%>%
  arrange(desc(Count))

```

The same as the occupation info, there are four big categories- unemployed, 
self-employed, retired and employed, and the employed part is composed of all 
the companies in our dataset.So in this section,I will plot the four big 
categories, and then draw the top companies in the employed category with most 
donations. As we could see, people in several university were proacively involoved 
in the contribution of presidential campaign, followed by  private foundation, 
goverment agency and some big technology companies.

```{r echo=FALSE,message=FALSE, warning=FALSE, Univariate_Plots_12}
# From the big four categories,
campaign_employer_test<-campaign%>% group_by(contbr_employer)%>%
   summarise(Amount_Ave=mean(contb_receipt_amt),
             Amount_Sum=sum(contb_receipt_amt),
            Count=n())%>%
  arrange(desc(Count))

a<-campaign_employer_test%>% filter(contbr_employer=='RETIRED')%>%
  mutate(employer='RETIRED')
b<-campaign_employer_test%>% filter(contbr_employer=='SELF-EMPLOYE')%>%
  mutate(employer='SELF-EMPLOYE')
c<-campaign_employer_test%>% filter(contbr_employer=='UNEMPLOYED')%>%
  mutate(employer='UNEMPLOYED')
d<-campaign_employer_test%>% filter(contbr_employer=='N/A')%>%
  mutate(employer='N/A')
e<-campaign_employer_test%>% filter(contbr_employer!='N/A',contbr_employer!='RETIRED',contbr_employer!='SELF-EMPLOYE',contbr_employer!='UNEMPLOYED')%>%
  mutate(employer='EMPLOYED')

campaign_employer_F<-rbind(a,b,c,d,e)%>%group_by(employer)%>%
  summarise(Amount_Ave_F=mean(Amount_Ave),
            Amount_Sum_F=sum(Amount_Sum),
            Count_F=sum(Count))


ggplot(aes(x=reorder(employer,Count_F/(10^3)),y=Count_F),data=campaign_employer_F[campaign_employer_F$employer!="N/A",])+
  geom_bar(stat="identity")+
  ggtitle("Count of Donations for Employed Status in Thousands")+
   theme(plot.title = element_text(hjust = 0.5))+
  ylab('Count of Donations Received')+
  xlab("Employment Status")

ggplot(aes(x=reorder(employer,Amount_Ave_F),y=Amount_Ave_F),data=campaign_employer_F[campaign_employer_F$employer!="N/A",])+
  geom_bar(stat="identity")+
  ggtitle("Avg of Donations for Employed Status")+
   theme(plot.title = element_text(hjust = 0.5))+
   ylab('Average Donations Received')+
  xlab("Employment Status")

# For the detailed info in the employed group,
campaign_employer_active<-campaign%>% 
  filter(contbr_employer!='RETIRED',contbr_employer!='SELF-EMPLOYED',contbr_employer!='UNEMPLOYED',contbr_employer!='N/A', contbr_employer!='INFORMATION REQUESTED')%>%
  group_by(contbr_employer)%>%
   summarise(Amount_Ave=mean(contb_receipt_amt),
             Amount_Sum=sum(contb_receipt_amt),
            Count=n())%>%
  arrange(desc(Count))%>%
  top_n(20,Count)

ggplot(aes(x=reorder(contbr_employer,Count),y=Count),data=campaign_employer_active[campaign_employer_active$contbr_employer!="N/A"&campaign_employer_active$contbr_employer!="INFORMATION REQUESTED",])+
  geom_bar(stat="identity")+
  coord_flip()+
  ggtitle("Count of Donations from Different Employers")+
   theme(axis.text= element_text(size=8),plot.title = element_text(hjust = 0.5),axis.title =element_text(size=10))+
   ylab('Count of Donations Received')+
  xlab("Employers")

ggplot(aes(x=reorder(contbr_employer,Amount_Sum),y=Amount_Sum),data=campaign_employer_active[campaign_employer_active$contbr_employer!="N/A"&campaign_employer_active$contbr_employer!="INFORMATION REQUESTED",])+
  geom_bar(stat="identity")+
  coord_flip()+
  ggtitle("Total of Donations from Different Employers")+
   theme(axis.text= element_text(size=8),plot.title = element_text(hjust = 0.5),axis.title =element_text(size=10))+
   ylab('Total of Donations Received')+
  xlab("Employers")

```


> **Question Answering**

##### What is the structure of your dataset?
This dataset includes 649460 obs. of 18 variables, and 
most of them are categorical variables (15).

##### What is/are the main feature(s) of interest in your dataset?
From what I explored above, the main feature that i am interested are,
- What's the difference between those parties supporters?

- Which party will the contributor donate to based on their background info?

- What could impact the contribution amount?

- What's the best time to get the donations and where are those huge financial 
support coming from?

##### What other features in the dataset do you think will help support your analysis?

- Candidiate's name info: I could get their party info based on their name, 
which could help us understand a political party general support picture in New York.

- Contributor's career info: Although it is too varied, it still carried some 
important info like which industries they are in and how much they could earn, 
and all those info might be the reason that they put their donation to the 
certain party.

- Contributor's location info: Provide the spatial distribution of those 
contributor, which might have the difference between different parties.

- Contributor's name info: Although most people do not continuously donate during 
that campaign period, we could guess their gender info only based on the name, 
which might be useful to look into the gender distribution in the NY campaign contribution.

- Zipcode demographics info: It will help us to understand our contributors as 
well as the donation they put.

##### Did you create any new variables from existing variables in the dataset?

- Candidates' parties info.
- Contributors' gender info.
- Demographic info: including the total population, the income level, rent level, 
and the race percentage.

##### Of the features you investigated, were there any unusual distributions?

- For the contb_receipt_amt distribution, there are some negative value, which 
are not usual as the donation should be positive.

##### Did you perform any operations on the data to tidy, adjust, or change the form \ of the data? If so, why did you do this?

For this tidy dataset, it has some inconsistency in the contbr_employer, 
ontbr_occupation, and the contributors' street name and might need to preprocess. 
As the location info is too messy, I droped that variables and used the zipcode 
library to clean up represent the location.For the occupation and employer info, 
as there are too various, I am deciding to visualize the top 20 of them and 
categorizing them in several big categories like un-employer, retired, self-employer, and employed.


## Bivariate Plots Section

> **Tip**: Based on what you saw in the univariate plots, what relationships
between variables might be interesting to look at in this section? 

First, check out the correlation between numerical variables.

```{r echo=FALSE, Univariate_Plots-13}
keep <- !is.na(campaign$gender)
data_correlation<-subset(campaign, select = c("contb_receipt_amt","date_upto_elec","total_population","latitude","longitude","percent_white", "percent_black","percent_asian", "percent_hispanic","per_capita_income","median_rent","median_age","party","gender"))
campaign$party<-factor(campaign$party)
data_correlation$party<-factor(data_correlation$party)
data_correlation$gender<-factor(data_correlation$gender)
correlations <- hetcor(data_correlation[keep,], std.err = FALSE)
correlations
```


With the univariant analysis, now I will check the distribution across parties, 
candidates, genders, and occupations.

Contribution by Parties

In the first part, we know that more people would love to make donations for 
democrat party. In 2017 presidential campaign, democrat definitly got the big win 
compared to another two in New York State towards the money they got. Most 
people donate around 100 dolloars in both democrat and republican party, and 
people would love to donate more in the third party although there are less 
people involved in their donations. For the mean contribution amount, the rank 
was third party>republican>democrat, and IQ range has the same rank. 

For the gender, more female donators were for in the democrat party, whereas in 
the republican party, the male donators totally dominate the contribution and 
they tend to donate more compared to the democrat party.The mean contribution 
amount as well as the IQ range is larger for males than females and they are significantly different. 

```{r echo=FALSE, message=FALSE, warning=FALSE, Bivariate_Plots_1}
#Create party frame

p1<-ggplot(aes(x=party,y=contb_receipt_amt/10^3,fill=gender),data=na.omit(campaign))+
  geom_bar(stat='summary',fun.y=sum,position='dodge')+
  ggtitle("Financial Contribution by Party")+
  theme(axis.text= element_text(size=8),plot.title = element_text(hjust = 0.5),axis.title =element_text(size=10),legend.title =element_text(size=8))+
  xlab("Party")+
  ylab("Total Amount (in thousands)")
  

p2<-ggplot(aes(x=gender,y=contb_receipt_amt,fill=gender),data=na.omit(campaign))+
  geom_boxplot()+
  facet_wrap(~party)+
  stat_summary(fun.y=mean,geom='point',size=3,color='red')+
  scale_fill_brewer(palette = 'Set1', direction = -1, guide = FALSE) +
  coord_cartesian(ylim = c(0, 600))+
  ggtitle("Financial Contributions by Party")+
  theme(axis.text= element_text(size=8),plot.title = element_text(hjust = 0.5),axis.title =element_text(size=10))+
  ylab("Amount of Contributions")

grid.arrange(p1, p2, ncol = 1)
tapply(campaign$contb_receipt_amt, campaign$gender, summary)
wilcox.test(contb_receipt_amt ~ gender, data = campaign)


```

Contribution by Candidates

From the general plots, the top three candidates that received the most 
donations are Hilary, Bernard, Trump, Cruz. On the other hand, based on the 
boxplot, we could see that most of the donations they got were below 500. 

For the candidate behind each donation, we could notify that Hillary won the 
most donations, followed by Bernard and Trump in 2017 presidential campaign.

```{r echo=FALSE, message=FALSE, warning=FALSE,Bivariate_Plots_1_2}
#cand_nm plot

#table(campaign$cand_nm)
campaign%>%group_by(cand_nm,party)%>%
  summarise(sum=sum(contb_receipt_amt),
            mean=mean(contb_receipt_amt),
            median=median(contb_receipt_amt),
            n=n())%>%
  arrange(desc(sum))

#qplot(x=cand_nm,data=campaign)
ggplot(aes(x=cand_nm,fill=party),data=campaign)+
  geom_bar()+
  ggtitle("Count of Contributions by Candidate")+
  coord_flip()+
  theme(axis.text= element_text(size=8),plot.title = element_text(hjust = 0.5),axis.title =element_text(size=12) )+
  xlab("Candidate Name")+
  ylab("Number of Contribution received")
  
  
```

```{r echo=FALSE, message=FALSE, warning=FALSE,Bivariate_Plots_2}

campaign_person<-campaign%>%group_by(cand_nm,party,gender)%>%
  summarise(sum_person=sum(contb_receipt_amt),
            mean_person=mean(contb_receipt_amt),
            n=n())

ggplot(aes(x=reorder(cand_nm,sum_person),y=sum_person,fill=party),data=na.omit(campaign_person))+
  geom_bar(stat='identity')+
  coord_flip()+
  ggtitle("Total Financial Contribution by Candidates")+
  theme(axis.text= element_text(size=8),plot.title = element_text(hjust = 0.5),axis.title =element_text(size=10))+
  ylab("Total of Financial Contribution")+
  xlab("Names of Candidate")+
  scale_y_log10()

ggplot(aes(x=reorder(cand_nm,n),y=n,fill=party,label=round(n)),data=na.omit(campaign_person))+
  geom_bar(stat = 'identity')+
  coord_flip()+
  ggtitle(" Count of Financial Contribution by Candidates")+
  theme(axis.text= element_text(size=8),plot.title = element_text(hjust = 0.5),axis.title =element_text(size=10))+
  ylab("Count of Contribution Received")+
  xlab("Candidate")+
  scale_y_log10()

 ggplot(aes(x=cand_nm,y=contb_receipt_amt,fill=party),data=na.omit(campaign))+
  geom_boxplot()+
  coord_flip()+
  ggtitle("Contribution Received by Candidate")+
 theme(axis.text= element_text(size=8),plot.title = element_text(hjust = 0.5),axis.title =element_text(size=10))+
  xlab("Candidates")+
  ylab("Contributions Received")


```

Contribution by Candidate of Each Party

If we dive deep into each candidate within party, we could see that there are 
more female support Hillary, which made the female become the majority in the 
democrat contributors.

```{r echo=FALSE, message=FALSE, warning=FALSE,Bivariate_Plots_3}

p1<-ggplot(aes(x=reorder(cand_nm,log(contb_receipt_amt)),y=contb_receipt_amt/10^3,fill=gender),data=filter(campaign,party=='democrat',gender!='NA'))+
  geom_bar(stat="summary",fun.y=sum,position='dodge')+
   theme(axis.text= element_text(angle = 45, hjust = 1,size=8),plot.title = element_text(hjust = 0.5),axis.title =element_text(size=10))+
  ylab("Contribution Received")+
  xlab('Democrat Candidates')+
   guides(fill=FALSE)

p2<-ggplot(aes(x=reorder(cand_nm,contb_receipt_amt),y=contb_receipt_amt/10^3,fill=gender),data=filter(campaign,party=='republican',gender!='NA'))+
  geom_bar(stat="summary",fun.y=sum)+
   theme(axis.text= element_text(angle = 45, hjust = 1,size=6),plot.title = element_text(hjust = 0.5),axis.title =element_text(size=10))+
   ylab("Contribution Received")+
  xlab('Republican Candidates')+
   guides(fill=FALSE)

p3<-ggplot(aes(x=reorder(cand_nm,contb_receipt_amt),y=contb_receipt_amt/10^3,fill=gender),data=filter(campaign,party=='Libtertarian/other',gender!='NA'))+
  geom_bar(stat="summary",fun.y=sum)+
   theme(axis.text= element_text(angle = 45, hjust = 1,size=8),plot.title = element_text(hjust = 0.5),axis.title =element_text(size=10),legend.text = element_text(size=8))+
   ylab("Contribution Received")+
  xlab('Third Party Candidates')


grid.arrange(p1,p2,p3,ncol=3)



```

Contribution by Occupation

In the big perspective, republican got more donations from retired group than 
democrat, whereas democrat got more from employed and unemployed group.

```{r echo=FALSE, message=FALSE, warning=FALSE,Bivariate_Plots_4}

a1<-campaign%>% filter(contbr_employer=='RETIRED')%>%
  mutate(employer='RETIRED')
b1<-campaign%>% filter(contbr_employer=='SELF-EMPLOYE')%>%
  mutate(employer='SELF-EMPLOYE')
c1<-campaign%>% filter(contbr_employer=='UNEMPLOYED')%>%
  mutate(employer='UNEMPLOYED')
d1<-campaign%>% filter(contbr_employer=='N/A')%>%
  mutate(employer='N/A')
e1<-campaign%>% filter(contbr_employer!='N/A',contbr_employer!='RETIRED',contbr_employer!='SELF-EMPLOYE',contbr_employer!='UNEMPLOYED')%>%
  mutate(employer='EMPLOYED')

campaign_update<-rbind(a1,b1,c1,d1,e1)


ggplot(aes(x=party,y=log(contb_receipt_amt)),data=filter(campaign_update,employer!='N/A'))+
         geom_bar(stat='summary',fun.y=sum)+
  theme(axis.text= element_text(angle = 45, hjust = 1,size=6),plot.title = element_text(hjust = 0.5),axis.title =element_text(size=8),strip.text.x = element_text(size = 6))+
  facet_wrap(~employer)+
  ggtitle("Contribution Received by Party and Employer Type")+
  ylab('Contribution Received')+
  xlab('Party')

campaign_update$employer<-factor(campaign_update$employer)
correlations <- hetcor(subset(campaign_update,select=c("contb_receipt_amt","employer"))[keep, ], std.err = FALSE)
correlations
```
For the occupations, homemaker, CEO, real estate, and Lawer had the larger mean 
amount of distribution as well as the IQ range. In democrat donations, the 
mainforce were  Retired, lawyer, CEO, homemaker, and consultant, and republican 
has the similar mainforce. 

With respect to the top three candidiates, we could see that laywer put the most 
effort to support Hillary, followed by retired people. For candidate Berbard, 
unemployed people was the mainforce in the donation, and retired people played 
hard to support Trump.

```{r echo=FALSE, message=FALSE, warning=FALSE,Bivariate_Plots_5}

topcareer<-c('RETIRED','UNEMPLOYED', 'LAWYER','INFORMATION REQUESTED', 'TEACHER', 'PROFESSOR', 'CEO','DOCTOR','CONSULTANT', 'WRITER','HOMEMAKER', 'SELF EMPLOYED', 'NURSE', 'ARTIST', 'STUDENT', 'SALES', 'MANAGER', 'ENGINEER', 'REAL ESTATE', 'SOFTWARE ENGINEER','PYCHOLOGIST', 'DESIGNER', 'SOCIAL WORKER', 'MUSICIAN', 'ARCHITECT')

ggplot(aes(x=party,y=contb_receipt_amt),data=filter(campaign_update,contbr_occupation %in% topcareer))+
  geom_bar(stat='summary',fun.y=sum)+
  facet_wrap(~contbr_occupation)+
  theme(axis.text= element_text(angle = 45, hjust = 1,size=6),plot.title = element_text(hjust = 0.5),axis.title =element_text(size=8),strip.text.x = element_text(size = 4))+
   xlab("Party")+
  ylab("Contribution Received")+
  ggtitle("Contribution Received by Occupation")

ggplot(aes(x=reorder(contbr_occupation,contb_receipt_amt),y=contb_receipt_amt),data=filter(campaign_update,contbr_occupation %in% topcareer))+
  geom_boxplot()+
  theme(axis.text= element_text(angle = 45, hjust = 1,size=6),plot.title = element_text(hjust = 0.5),axis.title =element_text(size=8))+
   xlab("Occupation")+
  ylab("Contribution Received")+
  ggtitle("Contribution Received by Occupation")+
  coord_cartesian(ylim = c(0, 250))

ggplot(aes(x=reorder(contbr_occupation,contb_receipt_amt),y=contb_receipt_amt,fill=gender),data=filter(campaign_update,contbr_occupation %in% topcareer,cand_nm %in% c("Sanders, Bernard", "Clinton, Hillary Rodham", "Trump, Donald J.")))+
  geom_bar(stat='summary',fun.y=sum)+
  theme(axis.text= element_text(angle = 45, hjust = 1,size=6),plot.title = element_text(hjust = 0.5),axis.title =element_text(size=8))+
  facet_wrap(~cand_nm)+
  xlab("Occupation")+
  ylab("Contribution Received")+
   ggtitle("Contribution Received by Choosen Candidates within Top Occupations")

ggplot(aes(x=reorder(cand_nm,contb_receipt_amt),y=contb_receipt_amt),data=filter(campaign_update,contbr_occupation %in% topcareer,cand_nm %in% c("Sanders, Bernard", "Clinton, Hillary Rodham", "Trump, Donald J.")))+
  geom_bar(stat='summary',fun.y=sum)+
  theme(axis.text= element_text(angle = 45, hjust = 1,size=6),plot.title = element_text(hjust = 0.5),axis.title =element_text(size=6),strip.text.x = element_text(size = 4))+
  facet_wrap(~contbr_occupation)+
  xlab("Candidate")+
  ylab("Contribution Received")+
  ggtitle("Contribution Received by Choosen Candidates within Top Occupations")

```

Contribution by Employer

For the employer, people in several university employers are the mainforce in 
the democrat party, whereas homemakers made more contributions for the 
republican party. With respect to top 3 candidates, people in New York 
University and Columbia University donated the most for Hillary and Bernard, 
and homemaker contributed most for Trump.

```{r echo=FALSE, message=FALSE, warning=FALSE,Bivariate_Plots_6}

topemployer<-campaign_employer_active$contbr_employer

ggplot(aes(x=party,y=contb_receipt_amt),data=filter(campaign_update,contbr_employer %in% topemployer))+
  geom_bar(stat='summary',fun.y=sum)+
  facet_wrap(~contbr_employer)+
   theme(axis.text= element_text(angle = 45, hjust = 1,size=6),plot.title = element_text(hjust = 0.5),axis.title =element_text(size=8), strip.text.x = element_text(size = 6))+
   xlab("Party")+
  ylab("Contribution Received")+
  ggtitle("Contribution Received by Party within Top Employers")

ggplot(aes(x=reorder(contbr_employer,contb_receipt_amt),y=contb_receipt_amt,fill=gender),data=filter(campaign_update,contbr_employer %in% topemployer,cand_nm %in% c("Sanders, Bernard", "Clinton, Hillary Rodham", "Trump, Donald J.")))+
  geom_bar(stat='summary',fun.y=sum)+
   theme(axis.text= element_text(angle = 45, hjust = 1,size=6),plot.title = element_text(hjust = 0.5),axis.title =element_text(size=8), strip.text.x = element_text(size = 6))+
  facet_wrap(~cand_nm)+
  xlab("Occupation")+
  ylab("Contribution Received")+
   ggtitle("Contribution Received by Choosen Candidates within Top Employers")

ggplot(aes(x=cand_nm,y=contb_receipt_amt),data=filter(campaign_update,contbr_employer %in% topemployer,cand_nm %in% c("Sanders, Bernard", "Clinton, Hillary Rodham", "Trump, Donald J.")))+
  geom_bar(stat='summary',fun.y=sum)+
  facet_wrap(~contbr_employer)+
  theme(axis.text= element_text(angle = 45, hjust = 1,size=6),plot.title = element_text(hjust = 0.5),axis.title =element_text(size=8),strip.text.x = element_text(size = 6))+
   xlab("Party")+
  ylab("Contribution Received")+
  ggtitle("Contribution Received by Party within Top Employers")

```


Contribution by Date

First, I would love to check the correlation between the time and contribution. 
We could notice that the correlation is not that strong, but there are two peaks 
in this trend, and the second one is really near the final call of the election.

```{r echo=FALSE, message=FALSE, warning=FALSE, Bivariate_Plots_7}
campaign_trend<-campaign%>%filter(year(campaign$date)==c("2015","2016"))
ggplot(aes(x=date,y=contb_receipt_amt),data=campaign_trend)+ 
  geom_smooth()+
  geom_jitter(aes(color=party),alpha = 0.005)+
  xlab("Date")+
  ylab("Total Contribution Received ")+
  ggtitle("Time Series of Contribution by Candidate")+
  coord_cartesian(ylim = c(0, 1000))+
  theme(axis.text= element_text(angle = 45, hjust = 1,size=8),plot.title = element_text(hjust = 0.5),axis.title =element_text(size=10),legend.text = element_text(size=8),legend.title =element_text(size=8) )+
  labs(color='Party',size=8) 

cor.test(as.numeric(campaign_trend$date),campaign_trend$contb_receipt_amt)

```

If we look at each month of the year, what does the distribution look like? We 
could see in general there were peaks after the holiday month and there were more 
contributions in 2016 than 2015.

```{r echo=FALSE, Bivariate_Plots_8}
# As we see most of the donations were in 2015 and 2016, so I will excluede the contribution of 2013 and 2014 in our plot.
table(year(campaign$date))

ggplot(data=campaign_trend, aes(x = month(date),labels=TRUE,
                            fill = as.factor(year(campaign_trend$date)))) +
    geom_bar(position = "dodge", color = "black") +
    scale_x_continuous(breaks=c(3,6,9,12),labels=c("March","June","Sep","Dec"))+
    scale_fill_manual(values = c("blue","red"),name="Year", breaks=c('2015','2016'),labels=c('2015','2016')) +
    ggtitle('Distribution by Month of Year 2015 and 2016') +
    xlab('Month') + 
    ylab('Number of Contributions')+
   theme(axis.text= element_text(hjust = 1,size=8),plot.title = element_text(hjust = 0.5),axis.title =element_text(size=10),legend.text = element_text(size=8),legend.title =element_text(size=8))
```

For each party contribution trend, we could see except they all had the second 
peak that nearby the election, the republican and third party were more fluctuate, 
and there was a huge increase for the third party contribution when the election 
was approaching, which I feel that there is a proportion people in last year do 
not want to support either Hilary or Trump.

```{r echo=FALSE, message=FALSE, warning=FALSE,Bivariate_Plots_9}

ggplot(aes(x=date,y=contb_receipt_amt,color=party),data=campaign)+
  geom_jitter(alpha = 0.005) +
  geom_smooth()+
  facet_wrap(~party)+
  xlab("Date")+
  ylab("Contribution Received ")+
  ggtitle("Time Series of Contribution by Candidate")+
  coord_cartesian(ylim = c(0, 1000))+
  theme(axis.text= element_text(hjust = 1,size=8),plot.title = element_text(hjust = 0.5),axis.title =element_text(size=10),legend.text = element_text(size=8),legend.title =element_text(size=8))

```

Finally, zooming into the candidates perspective. Hillary had an increasing trend 
of the contribution, even after the election. For Trump, there was an obvious peak 
nearby the election, and suddenly dropped down.Bernard seems get more donations 
in the early 2016, but falled behind Trump nearby the election.

```{r echo=FALSE, message=FALSE, warning=FALSE,Bivariate_Plots_10}

campaign_cand_date<-campaign%>% group_by(cand_nm,date,party)%>%
  summarise(median_date=median(contb_receipt_amt),
            average_date=mean(contb_receipt_amt),
            sum_date=sum(contb_receipt_amt),
            count_date=n())

ggplot(aes(x=date,y=sum_date/10^3,color=cand_nm),data=filter(campaign_cand_date,cand_nm %in% c("Sanders, Bernard", "Clinton, Hillary Rodham", "Trump, Donald J.")))+ 
  geom_smooth()+
  geom_jitter(alpha = 0.05)+
  xlab("Date")+
  ylab("Total Contribution Received (in thousand) ")+
  ggtitle("Time Series of Contribution by Candidates")+
  coord_cartesian(ylim = c(0, 1000))+
   theme(axis.text= element_text(hjust = 1,size=8),plot.title = element_text(hjust = 0.5),axis.title =element_text(size=10),legend.text = element_text(size=8),legend.title =element_text(size=8))

ggplot(aes(x=date,y=median_date,color=party),data=filter(campaign_cand_date,cand_nm %in% c("Sanders, Bernard", "Clinton, Hillary Rodham", "Trump, Donald J.")))+
  geom_jitter(alpha = 0.2) +
  geom_smooth()+
  facet_wrap(~cand_nm)+
  xlab("Date")+
  ylab("Median Contribution Received ")+
  ggtitle("Time Series of Contribution by Candidates")+
coord_cartesian(ylim = c(0, 1000))+
   theme(axis.text= element_text(hjust = 1,size=8),plot.title = element_text(hjust = 0.5),axis.title =element_text(size=10),legend.text = element_text(size=8),legend.title =element_text(size=8))

ggplot(aes(x=date,y=count_date,color=party),data=filter(campaign_cand_date,cand_nm %in% c("Sanders, Bernard", "Clinton, Hillary Rodham", "Trump, Donald J.")))+
  geom_jitter(alpha = 0.2) +
  geom_smooth()+
  facet_wrap(~cand_nm)+
  xlab("Date")+
  ylab("Count of Contribution Received ")+
  ggtitle("Time Series of Contribution by Candidates")+
coord_cartesian(ylim = c(0, 1000))+
   theme(axis.text= element_text(hjust = 1,size=8),plot.title = element_text(hjust = 0.5),axis.title =element_text(size=10),legend.text = element_text(size=8),legend.title =element_text(size=8))

```

For all the demographic features behind the zipcode region, the income per 
capita and the median rent has a weak correlation with the contribution amount.

```{r echo=FALSE, message=FALSE, warning=FALSE,Bivariate_Plots_11}

correlations <- hetcor(campaign[keep, c(11,24:31)], std.err = FALSE)
correlations

ggplot(data = campaign, aes(x = per_capita_income, y = contb_receipt_amt)) +
  geom_jitter(alpha = 0.02) +
  geom_smooth(color = "red") +
  coord_cartesian(ylim = c(0, 1000))

ggplot(data = campaign, aes(x = median_rent, y = contb_receipt_amt)) +
  geom_jitter(alpha = 0.02) +
  geom_smooth(color = "red") +
  coord_cartesian(ylim = c(0, 1000))

```

Finally, I want to look at the contribution amount with the zipcode on the map. 
As what we see, most of their contribution are from New York city, but republican 
do have a certain proportion from the rural area in New York State.

```{r echo=FALSE,message=FALSE, warning=FALSE}

d1<-ggplot(aes(x=latitude,y=longitude,color=party),data=campaign)+
  geom_point(, data=campaign, alpha = 0.005)+
  scale_color_brewer(palette='Set1')+
  ggtitle("Distribution of Donators in NY State")+
  theme(legend.title =element_text(size=8) ,legend.text=element_text(size=7),plot.title = element_text(size=10,hjust = 0.5),axis.text= element_text(size=8),axis.title =element_text(size=12))

d2 <-ggplot(aes(x=latitude,y=longitude),data=campaign)+
  geom_density2d()+
  scale_color_brewer(palette='Set1')+
  theme(legend.text=element_text(size=7),axis.text= element_text(size=8),axis.title =element_text(size=12))


grid.arrange(d1, d2,ncol = 2) 

```


```{r echo=FALSE,message=FALSE, warning=FALSE, Bivariate_Plots_12}
# create the map
campagin.republican<-campaign%>%
  filter(zipcode!='NA',party=='republican')%>%
   group_by(zipcode)%>%
  summarise(Total=sum(contb_receipt_amt),
            Median=median(contb_receipt_amt),
            Mean=mean(contb_receipt_amt))

campagin.republican$value=campagin.republican$Total
campagin.republican$region=campagin.republican$zipcode
campagin.republican<-na.omit(campagin.republican)

#str(campagin.republican)
#summary(campagin.republican)
zip_map = ZipChoropleth$new(campagin.republican)
zip_map$ggplot_polygon = geom_polygon(aes(fill = value)
                                      )
zip_map$set_zoom_zip(state_zoom  = c("new york"), 
                     county_zoom = NULL, 
                     msa_zoom    = NULL, 
                     zip_zoom    = NULL) 

zip_map$title = "Total Contribution for Republican in New York State "
zip_map$legend = "Sum"
zip_map$set_num_colors(6)
choro = zip_map$render()

#create the state outlines
data(df_pop_state)
outline = StateChoropleth$new(df_pop_state)
outline = outline$render_state_outline(c("new york")) 

#render the combined maps
choro_with_outline = choro + outline
choro_with_outline

# create the map
campagin.democrat<-campaign%>%
  filter(zipcode!='NA',party=='democrat')%>%
   group_by(zipcode)%>%
  summarise(Total=sum(contb_receipt_amt),
            Median=median(contb_receipt_amt),
            Mean=mean(contb_receipt_amt))

campagin.democrat$value=campagin.democrat$Total
campagin.democrat$region=campagin.democrat$zipcode
campagin.democrat<-na.omit(campagin.democrat)


zip_map = ZipChoropleth$new(campagin.democrat)
zip_map$ggplot_polygon = geom_polygon(aes(fill = value)
                                      )
zip_map$set_zoom_zip(state_zoom  = c("new york"), 
                     county_zoom = NULL, 
                     msa_zoom    = NULL, 
                     zip_zoom    = NULL) 

zip_map$title = "Total Contribution for Democrat in New York State "
zip_map$legend = "Sum"
zip_map$set_num_colors(6)
choro = zip_map$render()

#create the state outlines
data(df_pop_state)
outline = StateChoropleth$new(df_pop_state)
outline = outline$render_state_outline(c("new york")) 

#render the combined maps
choro_with_outline = choro + outline
choro_with_outline

```

```{r echo=FALSE,message=FALSE, warning=FALSE, Bivariate_Plots_13}
# create the map
campagin.republican<-campaign%>%
  filter(zipcode!='NA',party=='republican')%>%
   group_by(zipcode)%>%
  summarise(Total=sum(contb_receipt_amt),
            Median=median(contb_receipt_amt),
            Mean=mean(contb_receipt_amt))

campagin.republican$value=campagin.republican$Mean
campagin.republican$region=campagin.republican$zipcode
campagin.republican<-na.omit(campagin.republican)

#str(campagin.republican)
#summary(campagin.republican)
zip_map = ZipChoropleth$new(campagin.republican)
zip_map$ggplot_polygon = geom_polygon(aes(fill = value)
                                      )
zip_map$set_zoom_zip(state_zoom  = c("new york"), 
                     county_zoom = NULL, 
                     msa_zoom    = NULL, 
                     zip_zoom    = NULL) 

zip_map$title = "Mean Contribution for Republican in New York State "
zip_map$legend = "Mean"
zip_map$set_num_colors(6)
choro = zip_map$render()

#create the state outlines
data(df_pop_state)
outline = StateChoropleth$new(df_pop_state)
outline = outline$render_state_outline(c("new york")) 

#render the combined maps
choro_with_outline = choro + outline
choro_with_outline

# create the map
campagin.democrat<-campaign%>%
  filter(zipcode!='NA',party=='democrat')%>%
   group_by(zipcode)%>%
  summarise(Total=sum(contb_receipt_amt),
            Median=median(contb_receipt_amt),
            Mean=mean(contb_receipt_amt))

campagin.democrat$value=campagin.democrat$Mean
campagin.democrat$region=campagin.democrat$zipcode
campagin.democrat<-na.omit(campagin.democrat)


zip_map = ZipChoropleth$new(campagin.democrat)
zip_map$ggplot_polygon = geom_polygon(aes(fill = value))
zip_map$set_zoom_zip(state_zoom  = c("new york"), 
                     county_zoom = NULL, 
                     msa_zoom    = NULL, 
                     zip_zoom    = NULL) 

zip_map$title = "Mean Contribution for Democrat in New York State "
zip_map$legend = "Mean"
zip_map$set_num_colors(6)
choro = zip_map$render()

#create the state outlines
data(df_pop_state)
outline = StateChoropleth$new(df_pop_state)
outline = outline$render_state_outline(c("new york")) 

#render the combined maps
choro_with_outline = choro + outline
choro_with_outline

```


## Bivariate Analysis

> **Tip**: Summarize what you found in your bivariate explorations
here. Use the questions below to guide your discussion.

##### Talk about some of the relationships you observed in this part of the \
investigation. How did the feature(s) of interest vary with other features in \
the dataset?

There is no strong correlation between other features and contribution amount. 
Only party, median rent and income per capita are more correlated as their 
correlation is larger than 0.1.

For other features,

- Gender: More female donators were for in the democrat party especially for 
Hillary, whereas in the republican party, the male donators totally dominate the contribution. 

- Occupation: Republican got more donations from retired group than democrat, 
whereas democrat got more from employed and unemployed group. The mainforce in 
the donation are Retired, lawyer, CEO, homemaker, and consultant. With respect 
to the top three candidiates, we could see that laywer put the most effort to 
support Hillary, followed by retired people. For candidate Berbard, unemployed 
people was the mainforce in the donation, and retired people played hard to support Trump.

- Employer: People in several university employers are the mainforce in the democrat party, whereas homemakers made more contributions for the republican party. With respect to top 3 candidates, people in New York University and Columbia University donated the most for Hillary and Bernard, and homemaker contributed most for Trump.

-Dates: There were peaks after the holiday month and there were more contributions in 2016 than 2015.

##### Did you observe any interesting relationships between the other features \
(not the main feature(s) of interest)?

The median rent strongly correlated to the income per capita, and 
the percentage of white is correlated to the percentage of black.


##### What was the strongest relationship you found?

The median rent is the strongest correlated to the income per capita. 
For the contribution amount, the most correlated feature is income per capita, 
followed by the median rent.


## Multivariate Plots Section

Now, I will pull out several correlated features including income per capita, 
median rent, and party, and map them with the contribution amount.

```{r echo=FALSE,message=FALSE, warning=FALSE, Multivariate_Plots}

f1<-ggplot(aes(x=per_capita_income,y=contb_receipt_amt,color=gender),data=na.omit(campaign))+
  geom_smooth()

f2<-ggplot(aes(x=per_capita_income,y=contb_receipt_amt,color=party),data=na.omit(campaign))+
  geom_smooth()

grid.arrange(f1,f2)

```

As what we could see, the people with more income will contribute more in the 
campaign, males tend to donate more with the same income, and the third party 
contributors tend to donate more with the same income. It is reasonable and 
understandable. But for the people with income less than 2000, the donation were varied.


```{r echo=FALSE, message=FALSE, warning=FALSE,Multivariate_Plots_2}

f3<-ggplot(aes(x=median_rent,y=contb_receipt_amt,color=gender),data=na.omit(campaign))+
  geom_smooth()

f4<-ggplot(aes(x=median_rent,y=contb_receipt_amt,color=party),data=na.omit(campaign))+
  geom_smooth()

grid.arrange(f3,f4)

```

People with higher median rent would love to donate more, which is reasonable 
and same as the relationship with the income per capita. For the people whose 
rent is below 500 dollars, their donations were a little varied, but not that much.

```{r echo=FALSE,message=FALSE, warning=FALSE, Multivariate_Plots_3}
f5<-ggplot(aes(x=date,y=contb_receipt_amt,color=gender),data=na.omit(campaign))+
  geom_smooth()

f6<-ggplot(aes(x=date,y=contb_receipt_amt,color=party),data=na.omit(campaign))+
  geom_smooth()

grid.arrange(f5,f6)
```


In general, the contribution dropped off as the time passed by, but the count increased.

```{r echo=FALSE, message=FALSE, warning=FALSE,Multivariate_Plots_4}
campaign.category<-campaign%>%group_by(gender,party,contbr_occupation,contbr_employer)%>%
  filter(contbr_occupation %in% topcareer,contbr_employer %in% topemployer)%>%
  summarise(avg=mean(contb_receipt_amt),
            sum=sum(contb_receipt_amt),
            count=n(),
            median=median(contb_receipt_amt))


ggplot(aes(x=contbr_occupation,y=contbr_employer),data=na.omit(campaign.category))+
  geom_raster(aes(fill = log(median))) +
    scale_fill_distiller(palette = "Greens", direction = 1) + theme_dark()+ 
  theme(axis.text= element_text(angle = 45, hjust = 1,size=6),plot.title = element_text(hjust = 0.5),axis.title =element_text(size=8),strip.text.x = element_text(size = 6))+
  facet_wrap(~party)
  
```

The map here is useful for the party to identify where those donations came from, 
and it might be useful for different part to identify their potential donators.


## Multivariate Analysis

##### Talk about some of the relationships you observed in this part of the \
investigation. Were there features that strengthened each other in terms of \
looking at your feature(s) of interest?

Except theincome per capita, median rent, and party info, the gender info and 
the date info do strength their correlation with the contribution amount.


##### Were there any interesting or surprising interactions between features?
With the increase of either rent or income per capita, the contribution amount 
increase more for republican than democrat, which means that republican supporters 
in the same income level as the democrat supporters were generous.

With the election approaching, the republican got more contributions especially 
nearby the election final call than the other parties in this democrat dominated 
states, which I guess they had the strategy in the whole country to get more 
people support themselves, which indirectly explain why Trump get into White House.

## Model Building 

Here I would love to try the logistic regression method to predict a donor's 
contributing party by their gender, income level, rent level, donation amount 
and number of days before the election (the way to transform the date to the numberic type).


```{r echo=FALSE, results="hide", Model_Building_1}

data.model<-subset(campaign,select=c("party","gender","contb_receipt_amt","date_upto_elec","per_capita_income","median_rent","median_age"))%>%
  filter(gender!='NA',party %in% c('democrat', 'republican'))
str(data.model)

data.model$party<-factor(data.model$party)
data.model$gender<-factor(data.model$gender)
#length(data.model[,1])
train<-data.model[1:350000,]
test<-data.model[350000:length(data.model[,1]),]
names(data.model)

```

```{r Model_Building_1_2}
model <- glm(party ~contb_receipt_amt+date_upto_elec+per_capita_income+median_rent+median_age+gender,family=binomial(link='logit'),data=train)
summary(model)
```


We could see that all the paramters that we selected are statistically significant, 
which means that they all play a role in the decision of which party they donate. 
When all other variable are the same, the more the amount of contribution or 
number of days before election or the median age, the more likely he or she is 
republican supporter. On the other hand, the higher income or the donator is 
female, he is more likely a democrat donator.

```{r echo=FALSE, Model_Building_2}
# Predict on the test data
model_pred_prob <- predict(model, test, type='response')
# Change probility to class of direction
model_pred_direction <- rep('democrat', nrow(test))
# Set decision boundry 0.5
model_pred_direction[model_pred_prob > 0.5] = 'republican'
# Create confusion matrix
table(model_pred_direction, test$party)
# Compute and print accuracy
cat ('Accuracy: ', 1-mean(model_pred_direction != test$party))
```


##### OPTIONAL: Did you create any models with your dataset? Discuss the strengths 
##### and limitations of your model.

The accuracy on the test set is 0.86, which is pretty good to predict their 
political support. But the accuracy cannot tell the actual performance of the 
model as the whole dataset is really imbalanced. But based on the model summary, 
we could see all the coefficients are little bit small as there are several 
numberical variables, it's little bit hard to make precise prediction if our 
donators info are not precisely correct.


------

## Final Plots and Summary

### Plot One
```{r echo=FALSE, message=FALSE, warning=FALSE,Plot_One,fig.width=10, fig.height=15}
# Time Series of Contribution with Party and Donator info
g1<-ggplot(aes(x=month(date), y=contb_receipt_amt/10^3, fill=as.factor(year(campaign$date))),data=campaign)+
  geom_bar(position = 'dodge',stat='summary',fun.y=sum)+
  ggtitle("Contribution by Time")+
  scale_x_continuous(breaks=c(3,6,9,12),labels = c("Mar","Jun","Sep","Dec"))+
  xlab('Month') + 
  ylab('Total of Contributions (in Thousands)')+
   theme(axis.text= element_text(hjust = 1,size=7),plot.title = element_text(hjust = 0.5,size=15),axis.title =element_text(size=7),legend.text = element_text(size=9),legend.title =element_text(size=9))+
  guides(fill=guide_legend(title="Year"))+
  facet_wrap(~party)

g2<-ggplot(aes(x=date,y=contb_receipt_amt,color=party),data=campaign)+
  geom_jitter(alpha = 0.005) +
  geom_smooth()+
  facet_wrap(~party)+
  xlab("Date")+
  ylab("Contribution Received ")+
  ggtitle("Time Series of Contribution by Party")+
  coord_cartesian(ylim = c(0, 1000))+
  theme(axis.text= element_text(hjust = 1,size=7),plot.title = element_text(hjust = 0.5,size=15),axis.title =element_text(size=7),legend.text = element_text(size=9),legend.title =element_text(size=9),strip.text.x = element_text(size = 6))
campaign_cand_date

g3<-ggplot(aes(x=date,y=sum_date/10^3,color=cand_nm),data=filter(campaign_cand_date,cand_nm %in% c("Sanders, Bernard", "Clinton, Hillary Rodham", "Trump, Donald J.")))+ 
  geom_smooth()+
  geom_jitter(alpha = 0.05)+
  xlab("Date")+
  ylab("Total Contribution Received (in thousand) ")+
  ggtitle("Time Series of Contribution by Candidates")+
  coord_cartesian(ylim = c(0, 1000))+
   theme(axis.text= element_text(hjust = 1,size=7),plot.title = element_text(hjust = 0.5,size=15),axis.title =element_text(size=7),legend.text = element_text(size=9),legend.title =element_text(size=9))+
  guides(fill=guide_legend(title="Candidate"))


grid.arrange(g1,g2,g3,ncol=1)

```

### Description One
As what we could see, the democrat dominate the donations in New York State. 
In general, the campaign got most donations in 2017, and it seems having the 
seasonal contribution peak especially after the summer and winter holiday season. 
All the parties has the second peak in their donation trend, but its occurance 
is little bit different as the third party came much earlier and the republican 
came much later.  For the top three candidates, we could see Clinton got the 
huge win in New York State. Sanders and Trump were paralleled in the amount of 
donations, but trump seems get more donations when approaching to the final call 
of the election.

### Plot Two
```{r echo=FALSE, message=FALSE, warning=FALSE,Plot_Two,fig.width=10, fig.height=15}
# Ploting the demographic features (income level and rent level) with the amount of contribution
f1<-ggplot(aes(x=per_capita_income,y=contb_receipt_amt,color=gender),data=na.omit(campaign))+
  geom_smooth()+
   xlab("Income Per Capita")+
  ylab("Contribution Received ")+
  ggtitle("Income Per Capita with Contribution Received")+
  theme(axis.text= element_text(hjust = 1,size=7),plot.title = element_text(hjust = 0.5,size=18),axis.title =element_text(size=7),legend.text = element_text(size=15),legend.title =element_text(size=15))

f2<-ggplot(aes(x=per_capita_income,y=contb_receipt_amt,color=party),data=na.omit(campaign))+
  geom_smooth()+
  xlab("Income Per Capita")+
  ylab("Contribution Received ")+
  ggtitle("Income Per Capita with Contribution Received")+
  theme(axis.text= element_text(hjust = 1,size=7),plot.title = element_text(hjust = 0.5,size=18),axis.title =element_text(size=7),legend.text = element_text(size=15),legend.title =element_text(size=15))

f3<-ggplot(aes(x=median_rent,y=contb_receipt_amt,color=gender),data=na.omit(campaign))+
  geom_smooth()+
  xlab("Median Rent")+
  ylab("Contribution Received ")+
  ggtitle("Median Rent with Contribution Received")+
  theme(axis.text= element_text(hjust = 1,size=7),plot.title = element_text(hjust = 0.5,size=18),axis.title =element_text(size=7),legend.text = element_text(size=15),legend.title =element_text(size=15))

f4<-ggplot(aes(x=median_rent,y=contb_receipt_amt,color=party),data=na.omit(campaign))+
  geom_smooth()+
  xlab("Median Rent")+
  ylab("Contribution Received ")+
  ggtitle("Median Rent with Contribution Received")+
  theme(axis.text= element_text(hjust = 1,size=7),plot.title = element_text(hjust = 0.5,size=18),axis.title =element_text(size=7),legend.text = element_text(size=15),legend.title =element_text(size=15))

grid.arrange(f1,f2,f3,f4, ncol=1)

```

### Description Two
The donator's income level and rent level are positively correlated with the 
amount of contribution, which is hidden behind the zipcode info they provided. 
As most donations were from the New York City, it is really hard to identify 
what's the difference spacially. But exploring those region's demographic info, 
we could notify that republican supporters were more generous than the democrat 
supporters, althought democrat supporters dominate the New York Region.

### Plot Three
```{r echo=FALSE,message=FALSE, warning=FALSE, Plot_Three, fig.width=10, fig.height=15}

H1<-ggplot(aes(x=reorder(contbr_occupation,contb_receipt_amt),y=contb_receipt_amt),data=filter(campaign_update,contbr_occupation %in% topcareer))+
  geom_boxplot()+
  theme(axis.text= element_text(angle=45,hjust = 1,size=7),plot.title = element_text(hjust = 0.5,size=18),axis.title =element_text(size=7),legend.text = element_text(size=15),legend.title =element_text(size=15))+
   xlab("Occupation")+
  ylab("Contribution Received")+
  ggtitle("Contribution Received by Occupation")+
  coord_cartesian(ylim = c(0, 250))

H2<-ggplot(aes(x=reorder(contbr_occupation,contb_receipt_amt),y=contb_receipt_amt,fill=gender),data=filter(campaign_update,contbr_occupation %in% topcareer,party %in% c("democrat", "republican", "Libtertarian/other"),gender!='NA'))+
  geom_bar(stat='summary',fun.y=sum)+
  theme(axis.text= element_text(angle=45,hjust = 1,size=7),plot.title = element_text(hjust = 0.5,size=18),axis.title =element_text(size=7),legend.text = element_text(size=15),legend.title =element_text(size=15))+
  facet_wrap(~party)+
  xlab("Occupation")+
  ylab("Contribution Received")+
   ggtitle("Contribution Received by Choosen Candidates within Top Occupations")

H3<-ggplot(aes(x=reorder(contbr_employer,contb_receipt_amt),y=contb_receipt_amt,fill=gender),data=filter(campaign_update,contbr_employer %in% topemployer,cand_nm %in% c("Sanders, Bernard", "Clinton, Hillary Rodham", "Trump, Donald J."),gender!='NA'))+
  geom_bar(stat='summary',fun.y=sum)+
   theme(axis.text= element_text(angle=45,hjust = 1,size=7),plot.title = element_text(hjust = 0.5,size=18),axis.title =element_text(size=7),legend.text = element_text(size=15),legend.title =element_text(size=15))+
  facet_wrap(~cand_nm)+
  xlab("Occupation")+
  ylab("Contribution Received")+
   ggtitle("Contribution Received by Choosen Candidates within Top Employers")


H4<-ggplot(aes(x=contbr_occupation,y=contbr_employer),data=na.omit(campaign.category))+
  geom_raster(aes(fill = log(median))) +
    scale_fill_distiller(palette = "Greens", direction = 1) + theme_dark()+ 
  theme(axis.text= element_text(angle=45,hjust = 1,size=7),plot.title = element_text(hjust = 0.5,size=18),axis.title =element_text(size=7),legend.text = element_text(size=15),legend.title =element_text(size=15))+
  facet_wrap(~party)+
  ggtitle('Median Contribution with Occupation and Employer Info')+
   xlab("Occupation")+
  ylab("Emloyer")+
  guides(fill=guide_legend(title=" Median Contribution (Log)"))


grid.arrange(H1,H2,H3,H4, ncol=1)

```

### Description Three
As we could see, the mainforce in New York State Campaign were CEO, Homemaker, 
Lawyer, real estate, doctor, and professor. The actively involoved employers 
were from university, government agency, and several technology companies.

Although different parties have different supporters, they do have specific 
characteristics when speaking with the career info. For the democrat party, 
their supporters mostly were from University, and their occupations were more 
like retired people, CEO, lawyer, homemaker or consultant. For the republican 
party, their supporters were more from homemakers, self-employed, and they were 
more like homemakers and retired people.
 
------

## Reflection

> **Tip**: Reflect on the exploration you performed and the insights you found. 
What were some of the struggles that you went through? What went well? What was 
surprising? Make sure you include an insight into future work that could be done 
with the dataset.

In this project, I was determined and designed to identify what's the reason 
behind the donations amount, and what's the difference between the different 
parties supporters. The most correlated feature with the contribution were party,
gender, median rent, income per capita, and the date of the donations. For the 
difference between different parties' supporters, if a male tend to donate more 
than average who lives in the region with lower income and lower rent, he is 
more probably a republican supporter.


For the challenges and difficulties I met,

Data Preprocessing
- The original dataset is little bit messy especially relates to the occupation, 
employer info, and geolocation info. For the geolocation info, I used the zipcode 
library to clean it and use the zipcode dataset to get the longitude and latitude 
based on the zipcode info. For the occupation info, I didn't clean and categorize 
all of them and only focus on the top 25 of them to clean, analysis and plot.

- The original dataset doesn't contain so many detailed info about the donators 
except the messy occupation and employer info. So I added gender info based on 
the prediction over the First name of the donators and other demographic info 
based on the zipcode, which definitely fulfill our data info and analysis.

Data Visualization
- It's really hard to organize the clear ananlytical and logical process before 
hand. So it takes time to try, to change, to find, to orgnize. 

- In order to visualize the geoinfo on the map, it takes me some time to find a 
way and visualize it. Still might not that clear about this part.

- In order to output the pretty nice graph,the size of the output, the text size, 
the legend format all take me some time to explore.

Data Modelling
- The plotting sometimes is not the direct way to find the relationship between 
variables. So I spent time to extract the info from the plot as well as try to 
identify the relationship based on the statistics method.

- As the occupation and employer info I didn't clean them up, so that they 
are not used in my logistic regression model.

For the success,

- Successfully clean up the zipcode and add geolocation info by zipcode dataset.
- Successfully predict the gender info based on the first name by the gender library.
- Adding more demographic info through the zipcode by thedf_zip_demographics dataset.
- Visualize various data with geom_bar,geom_jitter, geom_smooth, geom_raster, 
geom_density, geom_density2,geom_boxplot, and facet_wrap method. Also try to 
plot the info and visualize it on the map.
- Set up the logistics model with 0.86 accuracy.

Conclusion

By analyzing the financial campaign dataset, here are several intersting results that I found,
- New York State were domiated by democrat supporters, who are retired people or 
professor in the university, Lawyer, homemaker, and doctors.
- Hillary got the most donations, followed by Bernard, and Trump.
- Female donators were little bit more in the democrat supporters, and males 
definitely dominate the republican donations.
- In general, republican supporters were more generous and donated more than 
democrat if their income level is same.
- Party, income level, rent level, and gender info impact how much money people 
would love to donate. Also, time is very important, as more people would love to 
donate in the period after the holiday seasons.
- For democrat and republican supporters, they do have different characterics, 
especially with their career info. Homemaker is a huge part in the Trump donations, 
and university is the key in Hillary donations.

Shortcomings

- Not all the people get the predicted genders, which were removed from the analysis.
- Didn't clean up the career info, which were not included in the modelling.
- Although I plot the info on the map, but it didn't play the role to reveal that much useful info.

Future 

- As the map didn't play that importance in the analysis or reveal that much info, 
there might be a way to do some spatial analysis, which would be useful for us 
to spatially identify how those info were impacted with each other.
- It would be really intersting to analyze a swing state, and the national 
campaign finance dataset, which might would help us to identify the reason 
behind the Trump's success.


